function calc1() {
  dg_string = addDays(parseDate($('dossier_ddr').value, '.'), 14);
  dap_string = addDays(parseDate($('dossier_ddr').value, '.'), 283);
  ddr = parseDate($('dossier_ddr').value, '.');
  dappel = parseDate($('dossier_date_appel').value, '.');

  if ($('dossier_ddr').value != "" && $('dossier_date_appel').value != ""){
    $('dossier_dg').value = dg_string;
    $('dossier_dap').value = dap_string;
    $('dossier_sa').value = getSA(ddr, dappel);
  }
}

function calc2() {
  dra = parseDate($('dossier_dra').value, '.');
  ddr = parseDate($('dossier_ddr').value, '.')

  if ($('dossier_dra').value != "" && $('dossier_ddr').value != ""){
    $('dossier_terme').value = getSA(ddr, dra);
   }
}

function getSA(startDate, endDate) {
  start = startDate.getTime();
  end = endDate.getTime();
  days = (end - start) / (1000 * 60 * 60 * 24);
  weeks = Math.round(days/7);
  return weeks;
}

function parseDate(strDate, strSep) {
  dateArray = strDate.split(strSep);
  date = new Date(dateArray[2], dateArray[1]-1, dateArray[0]);
  return date;
}

function addDays(objDate, days) {
  objDate.setDate(objDate.getDate() + days);
  arrDate = new Array();
  arrDate.push(objDate.getDate(), objDate.getMonth()+1, objDate.getFullYear());
  return arrDate.join(".");
}

function reset() {
  $('dossier_sa').value = "";
  $('dossier_ddr').value = "";
  $('dossier_dg').value = "";
  $('dossier_dap').value = "";
}

document.observe('dom:loaded', function() {
  $('calc').observe('click', calc1);
  $('reset').observe('click', reset);
  $('dossier_dra').observe('mouseover', calc2);
});
